<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html">
<dom-module id="inscription-form">
  <template>
    <style is="custom-style">
      .flex-horizontal-with-ratios {
         @apply(--layout-horizontal);
      }
      .flexchild {
        @apply(--layout-flex);
      }
    </style>
    <form is="iron-form" method="get" action="/toto" id="participationform">
      <div id="container" class="container flex-horizontal-with-ratios">
      </div>
      <paper-button raised onclick="_submit(event)">Valider</paper-button>
      <paper-button raised onclick="_reset(event)">Reinitialiser</paper-button>
    </form>
    <script>
      function _submit(event) {
        Polymer.dom(event).localTarget.parentElement.submit();
      }
      function _reset(event) {
        var form = Polymer.dom(event).localTarget.parentElement
        form.reset();
      }

    </script>
  </template>
  <script>
    Polymer({
      is: 'inscription-form',
      properties : {
        inscriptiondata : {
          type : Object,
          observer : 'inscriptiondataHandler'
        }
       },
       inscriptiondataHandler: function(inscriptiondata) {
        var line = this.$.container;
        var length = 0, i=0;
        var epreuve;
        var nb = 0;
        var newCell;
        var cells =[];
        if (inscriptiondata!==null)
          length = inscriptiondata.length;
        for (i=0;i<length;i++){
          if (nb==3) nb=0;
          if (cells[nb]==undefined){
            newCell = document.createElement("div");
            Polymer.dom(newCell).setAttribute('class', 'flexchild');
            Polymer.dom(line).appendChild(newCell);
            cells.push(newCell);
          }
          else newCell = cells[nb];
          epreuve = inscriptiondata[i];
          nb++;
          var newCheckBox = document.createElement("paper-checkbox");
          Polymer.dom(newCheckBox).innerHTML = epreuve.desc;
          Polymer.dom(newCell).appendChild(newCheckBox);
          Polymer.dom(newCheckBox).setAttribute('name', epreuve.id);
          Polymer.dom(newCheckBox).setAttribute('value', 'false');
          var theBR = document.createElement("BR");
          Polymer.dom(newCell).appendChild(theBR);
        }
      },
      ready : function(){
        this.$.participationform.addEventListener('iron-form-submit', function(event) {
          event.preventDefault();
          this.fire('participation', {courses: event.detail});
        });
      }
    });
  </script>
</dom-module>
